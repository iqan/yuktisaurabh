/*
	By Osvaldas Valutis, www.osvaldas.info
	Available for use under the MIT License
*/

(function(a,k,l,B){var q=function(){var b=l.body||l.documentElement,b=b.style;return""==b.WebkitTransition?"-webkit-":""==b.MozTransition?"-moz-":""==b.OTransition?"-o-":""==b.transition?"":!1},r=!1===q()?!1:!0,t=function(b,a,e){var c={},d=q();c[d+"transform"]="translateX("+a+")";c[d+"transition"]=d+"transform "+e+"s linear";b.css(c)},x="ontouchstart"in k,y=k.navigator.pointerEnabled||k.navigator.msPointerEnabled,w=function(b){if(x)return!0;if(!y||"undefined"===typeof b||"undefined"===typeof b.pointerType)return!1;
if("undefined"!==typeof b.MSPOINTER_TYPE_MOUSE){if(b.MSPOINTER_TYPE_MOUSE!=b.pointerType)return!0}else if("mouse"!=b.pointerType)return!0;return!1};a.fn.imageLightbox=function(b){b=a.extend({selector:'id="imagelightbox"',allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,preloadNext:!0,enableKeyboard:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,onStart:!1,onEnd:!1,onLoadStart:!1,onLoadEnd:!1},b);var d=a([]),e=a(),c=a(),g=0,f=0,m=0,n=!1,q=function(c){return"a"==a(c).prop("tagName").toLowerCase()&&
(new RegExp(".("+b.allowedTypes+")$","i")).test(a(c).attr("href"))},z=function(){if(!c.length)return!0;var b=.8*a(k).width(),d=.9*a(k).height(),e=new Image;e.src=c.attr("src");e.onload=function(){g=e.width;f=e.height;if(g>b||f>d){var h=g/f>b/d?g/b:f/d;g/=h;f/=h}c.css({width:g+"px",height:f+"px",top:(a(k).height()-f)/2+"px",left:(a(k).width()-g)/2+"px"})}},v=function(h){if(n)return!1;h="undefined"===typeof h?!1:"left"==h?1:-1;if(c.length){if(!1!==h&&(2>d.length||!0===b.quitOnEnd&&(-1===h&&0==d.index(e)||
1===h&&d.index(e)==d.length-1)))return u(),!1;var f={opacity:0};r?t(c,100*h-m+"px",b.animationSpeed/1E3):f.left=parseInt(c.css("left"))+100*h+"px";c.animate(f,b.animationSpeed,function(){A()});m=0}n=!0;if(!1!==b.onLoadStart)b.onLoadStart();setTimeout(function(){c=a("<img "+b.selector+" />").attr("src",e.attr("href")).load(function(){c.appendTo("body");z();var p={opacity:1};c.css("opacity",0);if(r)t(c,-100*h+"px",0),setTimeout(function(){t(c,"0px",b.animationSpeed/1E3)},50);else{var g=parseInt(c.css("left"));
p.left=g+"px";c.css("left",g-100*h+"px")}c.animate(p,b.animationSpeed,function(){n=!1;if(!1!==b.onLoadEnd)b.onLoadEnd()});b.preloadNext&&(p=d.eq(d.index(e)+1),p.length||(p=d.eq(0)),a("<img />").attr("src",p.attr("href")).load())}).error(function(){if(!1!==b.onLoadEnd)b.onLoadEnd()});var f=0,k=0,l=0;c.on(y?"pointerup MSPointerUp":"click",function(a){a.preventDefault();if(b.quitOnImgClick)return u(),!1;if(w(a.originalEvent))return!0;a=(a.pageX||a.originalEvent.pageX)-a.target.offsetLeft;e=d.eq(d.index(e)-
(g/2>a?1:-1));e.length||(e=d.eq(g/2>a?d.length:0));v(g/2>a?"left":"right")}).on("touchstart pointerdown MSPointerDown",function(a){if(!w(a.originalEvent)||b.quitOnImgClick)return!0;r&&(l=parseInt(c.css("left")));f=a.originalEvent.pageX||a.originalEvent.touches[0].pageX}).on("touchmove pointermove MSPointerMove",function(a){if(!w(a.originalEvent)||b.quitOnImgClick)return!0;a.preventDefault();k=a.originalEvent.pageX||a.originalEvent.touches[0].pageX;m=f-k;r?t(c,-m+"px",0):c.css("left",l-m+"px")}).on("touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",
function(a){if(!w(a.originalEvent)||b.quitOnImgClick)return!0;50<Math.abs(m)?(e=d.eq(d.index(e)-(0>m?1:-1)),e.length||(e=d.eq(0>m?d.length:0)),v(0<m?"right":"left")):r?t(c,"0px",b.animationSpeed/1E3):c.animate({left:l+"px"},b.animationSpeed/2)})},b.animationSpeed+100)},A=function(){if(!c.length)return!1;c.remove();c=a()},u=function(){if(!c.length)return!1;c.animate({opacity:0},b.animationSpeed,function(){A();n=!1;if(!1!==b.onEnd)b.onEnd()})};a(k).on("resize",z);if(b.quitOnDocClick)a(l).on(x?"touchend":
"click",function(b){c.length&&!a(b.target).is(c)&&u()});if(b.enableKeyboard)a(l).on("keyup",function(a){if(!c.length)return!0;a.preventDefault();27==a.keyCode&&u();if(37==a.keyCode||39==a.keyCode)e=d.eq(d.index(e)-(37==a.keyCode?1:-1)),e.length||(e=d.eq(37==a.keyCode?d.length:0)),v(37==a.keyCode?"left":"right")});a(l).on("click",this.selector,function(c){if(!q(this))return!0;c.preventDefault();if(n)return!1;n=!1;if(!1!==b.onStart)b.onStart();e=a(this);v()});this.each(function(){if(!q(this))return!0;
d=d.add(a(this))});this.switchImageLightbox=function(a){var b=d.eq(a);if(b.length){var c=d.index(e);e=b;v(a<c?"left":"right")}return this};this.quitImageLightbox=function(){u();return this};return this};gg_activityIndicatorOn=function(){a('<div id="imagelightbox-loading"><div></div></div>').appendTo("body")};gg_activityIndicatorOff=function(){a("#imagelightbox-loading").remove()};gg_overlayOn=function(){a('<div id="imagelightbox-overlay"></div>').appendTo("body")};gg_overlayOff=function(){a("#imagelightbox-overlay").remove()};
gg_closeButtonOn=function(b){a('<button type="button" id="imagelightbox-close" title="Close"></button>').appendTo("body").on("click touchend",function(){a(this).remove();b.quitImageLightbox();return!1})};gg_closeButtonOff=function(){a("#imagelightbox-close").remove()};gg_captionOn=function(){var b=a('a[href="'+a("#imagelightbox").attr("src")+'"] img').attr("alt");0<b.length&&a('<div id="imagelightbox-caption">'+b+"</div>").appendTo("body")};gg_captionOff=function(){a("#imagelightbox-caption").remove()};
gg_navigationOn=function(b,d){var e=a(d);if(e.length){for(var c=a('<div id="imagelightbox-nav"></div>'),g=0;g<e.length;g++)c.append('<button type="button"></button>');c.appendTo("body");c.on("click touchend",function(){return!1});var f=c.find("button");f.on("click touchend",function(){var c=a(this);e.eq(c.index()).attr("href")!=a("#imagelightbox").attr("src")&&b.switchImageLightbox(c.index());f.removeClass("active");f.eq(c.index()).addClass("active");return!1}).on("touchend",function(){return!1})}};
gg_navigationUpdate=function(b){var d=a("#imagelightbox-nav button");d.removeClass("active");d.eq(a(b).filter('[href="'+a("#imagelightbox").attr("src")+'"]').index(b)).addClass("active")};gg_navigationOff=function(){a("#imagelightbox-nav").remove()};gg_arrowsOn=function(b,d){var e=a('<button type="button" class="imagelightbox-arrow imagelightbox-arrow-left"></button><button type="button" class="imagelightbox-arrow imagelightbox-arrow-right"></button>');e.appendTo("body");e.on("click touchend",function(c){c.preventDefault();
c=a(this);var e=a(d+'[href="'+a("#imagelightbox").attr("src")+'"]').index(d);c.hasClass("imagelightbox-arrow-left")?(--e,a(d).eq(e).length||(e=a(d).length)):(e+=1,a(d).eq(e).length||(e=0));b.switchImageLightbox(e);return!1})};gg_arrowsOff=function(){a(".imagelightbox-arrow").remove()}})(jQuery,window,document);